<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="UTF-8">
    <title>어떤일기</title>

    <meta property="og:title" content="어떤일기, AnyDiary" />
    <meta property="og:description" content="오늘은 어떤 일이 있었나요? 여러분의 감정을 짧게 공유해주세요." />
    <meta property="og:image" content="/static/image/meta.png" />
    {% include 'form.html' %}
    <!-- 로그인 유무에 따라 카드 링크 다르게 설정-->
    <!-- !!!반드시 html 내 위치 유지!!! -->
    <script>
        function list_diary(url) {
            $('#gridContainer').empty()
            $.ajax({
                type: 'GET',
                url: url,
                data: {},
                success: function (response) {
                    let rows = response['list_diary']
                    for (let i = 0; i < rows.length; i++) {
                        let contentId = rows[i]['contentId']
                        let title = rows[i]['title']
                        let content = rows[i]['content']
                        let username = rows[i]['username']
                        let date = rows[i]['date']
                        let emoticon = rows[i]['emoticon']
                        let temp_html = `
                        {% if username %}
                        <div class="item withId" id="${contentId}">
                            {% endif %}

                            {% if not username %}
                        <div class="item">
                            {% endif %}
                            <h3 class="title" id="${contentId}">${title}</h3>
                            <hr><br>
                            <p class="content" id="${contentId}" style="white-space: pre-line;">${content}</p>
                            <p class="username" id="${contentId}">${username}</p>
                            <p class="date" id="${contentId}">${date}</p>
                            <p class="emoticon" id="${contentId}">${emoticon}</p>
                        </div> 
                `
                        $('#gridContainer').prepend(temp_html)
                        const cards = document.querySelectorAll('.item')
                        cards.forEach((card) => {
                            card.onclick = (e) => {
                                let cardId = e.target.id
                                if (card.classList.contains('withId')) {
                                    location.href = `/readContent?id=${cardId}`
                                } else {
                                    alert('로그인 해주세요.')
                                    location.href = '/login'
                                }
                            }
                        })
                    }
                }
            })
        }
    </script>
</head>

<body>
    {% include "header.html" %}
    <div id="gridContainer">
    </div>

    <footer>ⓒ2022 어떤일기</footer>
    <script src="../static/js/main.js"></script>
</body>

</html>